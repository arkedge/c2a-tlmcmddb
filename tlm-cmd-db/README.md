# TlmCmd DB
- C2A を搭載した OBC 以外を含めたすべてのコンポーネント（コンポ）についてのテレメトリ・コマンド（テレコマ）を，統一的に管理するための Database のマスターファイル．
  - これによって，統一的な C2A の自動コード生成や，各コンポ試験時の WINGS 連携が可能となる．
- これまで Excel マクロブックの単体ファイルであったため，コンフリクトや他 SW との連携がいまいちだった．そこで，以下の点を改修した．
  - データ本体はすべて CSV として保存することで，データはテキスト化（git 管理しやすさの向上）
  - Excel マクロブック（xlsm）は純粋なビュアー，エディターとすることで， xlsm は一般ユーザーは上書き保存しなくていいように（できないように）．
- 一方で，以下の理由より，今後は脱 Excel をしていきたい．
  - Excel に埋め込まれる VBA が git 管理しづらい．
  - Windows 以外で使いづらい．

## 使い方
### Cmd DB
- DB 読み込み
  - xlsm を開くと自動的に読み込まれる．
  - 手動で読み込む場合は，「Utility」→「CSV 読み込み」
- DB 編集
  - 通常の Excel 操作．
- DB 書き出し
  - 「Utility」→「CSV 書き出し」

### Tlm DB
- DB 読み込み
  - xlsm を開くと自動的に読み込まれる．
  - 手動で読み込む場合は，「Check」→「CSV 読み込み」
- DB 編集
  - 通常の Excel 操作．数式もそのまま保存されるため，使用可能．
- DB 書き出し
  - 「Check」→「CSV 書き出し」
- テレメトリシートの追加
  - 適当に csv をコピーしてファイル名を変更したものを同じディレクトリに配置すれば，次回以降自動で読み込まれる．

## 自動コード生成
- C2A のコードは [c2a-tlm-cmd-code-generator](https://github.com/ut-issl/c2a-tlm-cmd-code-generator) で自動生成できる．

## その他の注意
- 「開発」→「Visual Basic」→「ツール」→「参照設定」→「Microsoft HTML Object Library」にチェックを入れる必要があるかもしれない．
- 古いOffice (Office 2016など) では動かないこともあるらしい．
  - `Workbooks.Open` がクラッシュすることがある．
